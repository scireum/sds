<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Made with all the love in the world
  ~ by scireum in Remshalden, Germany
  ~
  ~ Copyright by scireum GmbH
  ~ http://www.scireum.de - info@scireum.de
  -->

<project name="sds-server" default="ivy">

    <import file="../sirius/build/build-base.xml" />

    <!-- App module is not required -->
    <property name="no-app" value="true" />

    <!-- Load environment -->
    <property environment="env"/>

    <!-- Name of the product -->
    <property name="app.name" value="Software Distribution System" />
    <!-- Technical of the product which can be used as filename -->
    <property name="app.filename" value="sds-server" />

    <target name="build">
        <copy file="../go/sds.go" tofile="../go/sds-out.go" />
        <replace dir="../go"
                 token="@VERSION@"
                 value="${app.version}">
            <include name="sds-out.go" />
        </replace>
        <exec executable="bash">
            <arg value="../go/build.bash" />
        </exec>
        <delete file="../go/sds-out.go" />
        <antcall target="sirius.make" />
        <exec executable="../resources/assets/binaries/sds-linux">
            <arg value="push" />
            <arg value="sds-server" />
            <arg value="${dist.dir}/${app.filename}.zip" />
        </exec>
    </target>

</project>
